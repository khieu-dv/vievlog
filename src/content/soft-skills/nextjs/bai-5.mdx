# B√†i 5: Next.js App Router - Routing Basics

<div className="bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-6 mb-8 rounded-r-lg">
  <h2 className="text-2xl font-bold text-blue-800 mb-2">üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2>
  <p className="text-gray-700">N·∫Øm v·ªØng c∆° ch·∫ø ƒë·ªãnh tuy·∫øn (routing) trong Next.js App Router, hi·ªÉu ƒë∆∞·ª£c s·ª± kh√°c bi·ªát v·ªõi Pages Router v√† th·ª±c h√†nh x√¢y d·ª±ng c·∫•u tr√∫c routing cho m·ªôt ·ª©ng d·ª•ng th·ª±c t·∫ø.</p>
</div>

## üìö T·ªïng quan v·ªÅ App Router

### So s√°nh Pages Router vs App Router

```mermaid
graph TB
    A[Next.js Routing Systems] --> B[Pages Router]
    A --> C[App Router]
    
    B --> D[üìÅ pages/]
    B --> E[üîß Next.js 12 v√† tr∆∞·ªõc]
    B --> F[üìÑ File = Route]
    
    C --> G[üìÅ app/]
    C --> H[üîß Next.js 13+]
    C --> I[üìÇ Folder = Route]
```

<div className="grid grid-cols-1 md:grid-cols-2 gap-6 my-8">
  <div className="border rounded-lg p-4 hover:shadow-md transition-shadow">
    <h3 className="font-semibold text-red-600 mb-2">Pages Router (Legacy)</h3>
    <ul className="text-sm space-y-1">
      <li>‚Ä¢ File-based routing trong th∆∞ m·ª•c pages/</li>
      <li>‚Ä¢ M·ªói file .js/.ts = m·ªôt route</li>
      <li>‚Ä¢ S·ª≠ d·ª•ng _app.js v√† _document.js</li>
      <li>‚Ä¢ API routes trong pages/api/</li>
    </ul>
  </div>
  <div className="border rounded-lg p-4 hover:shadow-md transition-shadow border-green-300">
    <h3 className="font-semibold text-green-600 mb-2">App Router (Khuy·∫øn kh√≠ch)</h3>
    <ul className="text-sm space-y-1">
      <li>‚Ä¢ Folder-based routing trong th∆∞ m·ª•c app/</li>
      <li>‚Ä¢ M·ªói th∆∞ m·ª•c = m·ªôt route segment</li>
      <li>‚Ä¢ S·ª≠ d·ª•ng layout.js v√† page.js</li>
      <li>‚Ä¢ Server Components m·∫∑c ƒë·ªãnh</li>
    </ul>
  </div>
</div>

## üó∫Ô∏è Routing Terminology

| Thu·∫≠t ng·ªØ | ƒê·ªãnh nghƒ©a | V√≠ d·ª• |
|-----------|------------|-------|
| **Route** | M·ªôt ƒë∆∞·ªùng d·∫´n URL ho√†n ch·ªânh | `/products/shoes` |
| **Segment** | M·ªôt ph·∫ßn c·ªßa route ƒë∆∞·ª£c ph√¢n t√°ch b·ªüi `/` | `products`, `shoes` |
| **Nested Routes** | Routes l·ªìng nhau theo c·∫•u tr√∫c th∆∞ m·ª•c | `/blog/category/post` |
| **Dynamic Routes** | Routes v·ªõi tham s·ªë ƒë·ªông | `/products/[id]` |
| **Route Groups** | Nh√≥m routes kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn URL | `(marketing)/about` |

## üìÅ C·∫•u tr√∫c File-based Routing

### C·∫•u tr√∫c c∆° b·∫£n

```typescript
app/
‚îú‚îÄ‚îÄ layout.tsx          // Root layout
‚îú‚îÄ‚îÄ page.tsx           // Home page (/)
‚îú‚îÄ‚îÄ loading.tsx        // Loading UI
‚îú‚îÄ‚îÄ error.tsx          // Error UI
‚îú‚îÄ‚îÄ not-found.tsx      // 404 page
‚îú‚îÄ‚îÄ about/
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx       // /about
‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx     // Products layout
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx       // /products
‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx   // /products/[id]
‚îî‚îÄ‚îÄ blog/
    ‚îú‚îÄ‚îÄ page.tsx       // /blog
    ‚îî‚îÄ‚îÄ [...slug]/
        ‚îî‚îÄ‚îÄ page.tsx   // /blog/[...slug]
```

### Mapping th∆∞ m·ª•c sang Routes

```mermaid
graph LR
    A[app] --> B[homepage]
    A --> C[about]
    A --> D[products]
    C --> E[aboutpage]
    D --> F[productspage]
    D --> G[shoes]
    D --> H[productid]
```

## üèóÔ∏è T·∫°o Routes c∆° b·∫£n

### 1. Static Routes

<div className="bg-gray-50 p-4 rounded-lg border-l-4 border-gray-400 mb-4">
  <h4 className="font-medium mb-2">üìù V√≠ d·ª•: T·∫°o trang About</h4>
</div>

```typescript
// app/about/page.tsx
export default function AboutPage() {
  return (
    <div className="max-w-4xl mx-auto py-8 px-4">
      <h1 className="text-3xl font-bold mb-4">V·ªÅ ch√∫ng t√¥i</h1>
      <p className="text-gray-600">
        ƒê√¢y l√† trang gi·ªõi thi·ªáu v·ªÅ c√¥ng ty ch√∫ng t√¥i.
      </p>
    </div>
  )
}
```

### 2. Nested Routes

```typescript
// app/products/shoes/page.tsx
export default function ShoesPage() {
  return (
    <div>
      <h1>Danh s√°ch gi√†y</h1>
      <p>C√°c s·∫£n ph·∫©m gi√†y d√©p</p>
    </div>
  )
}

// app/products/clothes/page.tsx
export default function ClothesPage() {
  return (
    <div>
      <h1>Danh s√°ch qu·∫ßn √°o</h1>
      <p>C√°c s·∫£n ph·∫©m th·ªùi trang</p>
    </div>
  )
}
```

## üîÑ Dynamic Routing

### Single Dynamic Segment `[id]`

```typescript
// app/products/[id]/page.tsx
interface ProductPageProps {
  params: {
    id: string
  }
}

export default function ProductPage({ params }: ProductPageProps) {
  const { id } = params
  
  return (
    <div className="container mx-auto p-4">
      <h1 className="text-2xl font-bold">S·∫£n ph·∫©m #{id}</h1>
      <p>Chi ti·∫øt s·∫£n ph·∫©m c√≥ ID: {id}</p>
    </div>
  )
}
```

### Catch-all Segments `[...slug]`

```typescript
// app/blog/[...slug]/page.tsx
interface BlogPostProps {
  params: {
    slug: string[]
  }
}

export default function BlogPost({ params }: BlogPostProps) {
  const { slug } = params
  
  return (
    <div>
      <h1>Blog Post</h1>
      <p>Slug segments: {slug.join(' ‚Üí ')}</p>
    </div>
  )
}
```

### Optional Catch-all `[[...slug]]`

| URL | params.slug |
|-----|-------------|
| `/blog` | `undefined` |
| `/blog/post-1` | `['post-1']` |
| `/blog/2023/post-1` | `['2023', 'post-1']` |

## üìÇ Route Groups v√† Private Folders

### Route Groups `(folder)`

<div className="bg-blue-50 p-4 rounded-lg mb-4">
  <p className="text-sm text-blue-700"><strong>üí° M·ª•c ƒë√≠ch:</strong> T·ªï ch·ª©c code m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn URL structure</p>
</div>

```typescript
app/
‚îú‚îÄ‚îÄ (marketing)/
‚îÇ   ‚îú‚îÄ‚îÄ about/page.tsx      // ‚Üí /about
‚îÇ   ‚îî‚îÄ‚îÄ contact/page.tsx    // ‚Üí /contact
‚îú‚îÄ‚îÄ (shop)/
‚îÇ   ‚îú‚îÄ‚îÄ products/page.tsx   // ‚Üí /products
‚îÇ   ‚îî‚îÄ‚îÄ cart/page.tsx       // ‚Üí /cart
‚îî‚îÄ‚îÄ page.tsx                // ‚Üí /
```

### Private Folders `_folder`

```typescript
app/
‚îú‚îÄ‚îÄ _components/          // Kh√¥ng accessible qua URL
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îî‚îÄ‚îÄ Footer.tsx
‚îú‚îÄ‚îÄ _lib/                // Utilities, kh√¥ng accessible
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts
‚îî‚îÄ‚îÄ products/
    ‚îî‚îÄ‚îÄ page.tsx         // ‚Üí /products
```

## üß≠ Th·ª±c h√†nh: X√¢y d·ª±ng Blog Structure

```mermaid
graph TD
    A[app] --> B[layout.tsx]
    A --> C[page.tsx Home]
    A --> D[blog]
    A --> E[about]
    A --> F[contact]
    
    D --> G[layout.tsx Blog Layout]
    D --> H[page.tsx Blog Home]
    D --> I[category]
    D --> J[slug]
    
    I --> K[category-param]
    K --> L[page.tsx Category Posts]
    
    J --> M[page.tsx Single Post]
```

### 1. Root Layout

```typescript
// app/layout.tsx
import './globals.css'

export const metadata = {
  title: 'My Blog',
  description: 'A Next.js blog with App Router',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="vi">
      <body className="min-h-screen bg-white">
        <nav className="bg-blue-600 text-white p-4">
          <div className="container mx-auto flex justify-between">
            <h1 className="text-xl font-bold">My Blog</h1>
            <div className="space-x-4">
              <a href="/" className="hover:underline">Home</a>
              <a href="/blog" className="hover:underline">Blog</a>
              <a href="/about" className="hover:underline">About</a>
            </div>
          </div>
        </nav>
        <main>{children}</main>
        <footer className="bg-gray-800 text-white p-8 mt-16">
          <div className="container mx-auto text-center">
            <p>&copy; 2024 My Blog. All rights reserved.</p>
          </div>
        </footer>
      </body>
    </html>
  )
}
```

### 2. Blog Layout

```typescript
// app/blog/layout.tsx
export default function BlogLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <div className="container mx-auto px-4 py-8">
      <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <aside className="lg:col-span-1">
          <div className="bg-gray-100 p-4 rounded-lg">
            <h3 className="font-bold mb-4">Danh m·ª•c</h3>
            <ul className="space-y-2">
              <li><a href="/blog/category/technology" className="text-blue-600 hover:underline">C√¥ng ngh·ªá</a></li>
              <li><a href="/blog/category/lifestyle" className="text-blue-600 hover:underline">L·ªëi s·ªëng</a></li>
              <li><a href="/blog/category/travel" className="text-blue-600 hover:underline">Du l·ªãch</a></li>
            </ul>
          </div>
        </aside>
        <div className="lg:col-span-3">
          {children}
        </div>
      </div>
    </div>
  )
}
```

### 3. Dynamic Category Page

```typescript
// app/blog/category/[category]/page.tsx
interface CategoryPageProps {
  params: {
    category: string
  }
}

export default function CategoryPage({ params }: CategoryPageProps) {
  const { category } = params
  
  // Mock data - trong th·ª±c t·∫ø s·∫Ω fetch t·ª´ API
  const posts = [
    { id: 1, title: `B√†i vi·∫øt ${category} #1`, excerpt: 'M√¥ t·∫£ ng·∫Øn...' },
    { id: 2, title: `B√†i vi·∫øt ${category} #2`, excerpt: 'M√¥ t·∫£ ng·∫Øn...' },
  ]
  
  return (
    <div>
      <h1 className="text-3xl font-bold mb-8 capitalize">
        Danh m·ª•c: {category.replace('-', ' ')}
      </h1>
      
      <div className="grid gap-6">
        {posts.map(post => (
          <article key={post.id} className="border rounded-lg p-6 hover:shadow-md transition-shadow">
            <h2 className="text-xl font-semibold mb-2">
              <a href={`/blog/${post.id}`} className="text-blue-600 hover:underline">
                {post.title}
              </a>
            </h2>
            <p className="text-gray-600">{post.excerpt}</p>
          </article>
        ))}
      </div>
    </div>
  )
}
```

## üìä Route Mapping Summary

### Static vs Dynamic Routes

| Route Type | C√∫ ph√°p | V√≠ d·ª• URL | File path |
|------------|---------|-----------|-----------|
| **Static** | `folder/page.tsx` | `/about` | `app/about/page.tsx` |
| **Dynamic** | `[param]/page.tsx` | `/products/123` | `app/products/[id]/page.tsx` |
| **Catch-all** | `[...params]/page.tsx` | `/blog/2023/post-1` | `app/blog/[...slug]/page.tsx` |
| **Optional** | `[[...params]]/page.tsx` | `/shop` ho·∫∑c `/shop/category` | `app/shop/[[...slug]]/page.tsx` |

### Special Files trong App Router

| File | M·ª•c ƒë√≠ch | B·∫Øt bu·ªôc |
|------|---------|----------|
| `layout.tsx` | Shared UI cho route v√† children | ‚úÖ (Root layout) |
| `page.tsx` | UI duy nh·∫•t cho route | ‚úÖ |
| `loading.tsx` | Loading UI | ‚ùå |
| `error.tsx` | Error UI | ‚ùå |
| `not-found.tsx` | Not found UI | ‚ùå |

## üéØ B√†i t·∫≠p th·ª±c h√†nh

<div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 my-6">
  <h3 className="font-semibold text-yellow-800 mb-2">üìù Th·ª±c h√†nh</h3>
  <p className="text-sm text-yellow-700">X√¢y d·ª±ng c·∫•u tr√∫c routing cho m·ªôt website e-commerce v·ªõi:</p>
  <ul className="list-disc list-inside text-sm text-yellow-700 mt-2 space-y-1">
    <li>Trang ch·ªß (<code>/</code>)</li>
    <li>Danh s√°ch s·∫£n ph·∫©m (<code>/products</code>)</li>
    <li>Chi ti·∫øt s·∫£n ph·∫©m (<code>/products/[id]</code>)</li>
    <li>Danh m·ª•c s·∫£n ph·∫©m (<code>/category/[category]</code>)</li>
    <li>Trang gi·ªè h√†ng (<code>/cart</code>)</li>
    <li>Trang v·ªÅ ch√∫ng t√¥i (<code>/about</code>)</li>
  </ul>
</div>

## ‚ú® T·ªïng k·∫øt

- **App Router** s·ª≠ d·ª•ng folder-based routing thay v√¨ file-based
- **Dynamic routing** cho ph√©p t·∫°o routes linh ho·∫°t v·ªõi `[param]` v√† `[...param]`
- **Route Groups** `(folder)` gi√∫p t·ªï ch·ª©c code m√† kh√¥ng ·∫£nh h∆∞·ªüng URL
- **Private folders** `_folder` ch·ª©a code kh√¥ng accessible qua URL
- **Special files** nh∆∞ `layout.tsx`, `page.tsx`, `loading.tsx` c√≥ vai tr√≤ ri√™ng bi·ªát

<div className="mt-8 p-6 border-2 border-green-200 rounded-lg bg-green-50">
  <h3 className="text-lg font-semibold text-green-800 mb-2">üéâ B√†i h·ªçc ti·∫øp theo</h3>
  <p className="text-green-700">B√†i 6: Layouts, Templates v√† Navigation - H·ªçc c√°ch t·∫°o layout v√† ƒëi·ªÅu h∆∞·ªõng trong App Router</p>
</div>